[Flippin' Awesome](http://flippinawesome.org/ "Flippin' Awesome")
=================================================================

[15 Must read articles **](#)

April 15, 2014

-   [![Prepocessor\_Architecture\_header](http://flippinawesome.org/wp-content/uploads/2014/04/Prepocessor_Architecture_header-110x110.jpg)](http://flippinawesome.org/2014/04/14/organizing-your-css-code-for-preprocessors/ "Organizing Your CSS Code for Preprocessors")
    [Organizing Your CSS Code for
    Preprocessors](http://flippinawesome.org/2014/04/14/organizing-your-css-code-for-preprocessors/ "Organizing Your CSS Code for Preprocessors")
-   [![es6\_header](http://flippinawesome.org/wp-content/uploads/2014/04/es6_header-110x110.jpg)](http://flippinawesome.org/2014/04/14/ecmascript-6-jump-in-the-water-is-warm/ "ECMAScript 6: Jump in, the water is warm!")
    [ECMAScript 6: Jump in, the water is
    warm!](http://flippinawesome.org/2014/04/14/ecmascript-6-jump-in-the-water-is-warm/ "ECMAScript 6: Jump in, the water is warm!")
-   [![engaging\_games\_header](http://flippinawesome.org/wp-content/uploads/2014/04/engaging_games_header-110x110.jpg)](http://flippinawesome.org/2014/04/14/ten-engagement-strategies-to-increase-the-profitability-of-your-mobile-game/ "Ten Engagement Strategies to Increase the Profitability of Your Mobile Game")
    [Ten Engagement Strategies to Increase the Profitability of Your
    Mobile
    Game](http://flippinawesome.org/2014/04/14/ten-engagement-strategies-to-increase-the-profitability-of-your-mobile-game/ "Ten Engagement Strategies to Increase the Profitability of Your Mobile Game")
-   [![oculus\_header](http://flippinawesome.org/wp-content/uploads/2014/04/oculus_header-110x110.jpg)](http://flippinawesome.org/2014/04/14/will-oculus-vr-and-amazon-fire-tv-change-web-app-development/ "Will Oculus VR and Amazon Fire TV Change Web App Development?")
    [Will Oculus VR and Amazon Fire TV Change Web App
    Development?](http://flippinawesome.org/2014/04/14/will-oculus-vr-and-amazon-fire-tv-change-web-app-development/ "Will Oculus VR and Amazon Fire TV Change Web App Development?")
-   [](http://flippinawesome.org/2014/04/10/web-standards-library-update-week-of-march-31-2014/ "Web Standards Library Update – Week of March 31, 2014")
    [Web Standards Library Update – Week of March 31,
    2014](http://flippinawesome.org/2014/04/10/web-standards-library-update-week-of-march-31-2014/ "Web Standards Library Update – Week of March 31, 2014")
-   [](http://flippinawesome.org/2014/04/09/best-of-javascript-html-css-march-31-2014/ "Best of JavaScript, HTML & CSS – Week of March 31, 2014")
    [Best of JavaScript, HTML & CSS – Week of March 31,
    2014](http://flippinawesome.org/2014/04/09/best-of-javascript-html-css-march-31-2014/ "Best of JavaScript, HTML & CSS – Week of March 31, 2014")
-   [![browser\_detection\_header](http://flippinawesome.org/wp-content/uploads/2014/04/browser_detection_header-110x110.jpg)](http://flippinawesome.org/2014/04/07/improving-browser-detection/ "Improving Browser Detection")
    [Improving Browser
    Detection](http://flippinawesome.org/2014/04/07/improving-browser-detection/ "Improving Browser Detection")
-   [![html5\_games\_engine\_header](http://flippinawesome.org/wp-content/uploads/2014/04/html5_games_engine_header-110x110.jpg)](http://flippinawesome.org/2014/04/07/lessons-learned-building-an-html5-games-engine/ "Lessons Learned Building an HTML5 Games Engine")
    [Lessons Learned Building an HTML5 Games
    Engine](http://flippinawesome.org/2014/04/07/lessons-learned-building-an-html5-games-engine/ "Lessons Learned Building an HTML5 Games Engine")
-   [![express\_routes\_header](http://flippinawesome.org/wp-content/uploads/2014/04/express_routes_header-110x110.jpg)](http://flippinawesome.org/2014/04/07/the-basics-of-express-routes/ "The Basics of Express Routes")
    [The Basics of Express
    Routes](http://flippinawesome.org/2014/04/07/the-basics-of-express-routes/ "The Basics of Express Routes")
-   [](http://flippinawesome.org/2014/04/03/web-standards-library-update-week-of-march-24-2014/ "Web Standards Library Update – Week of March 24, 2014")
    [Web Standards Library Update – Week of March 24,
    2014](http://flippinawesome.org/2014/04/03/web-standards-library-update-week-of-march-24-2014/ "Web Standards Library Update – Week of March 24, 2014")
-   [](http://flippinawesome.org/2014/04/02/best-of-javascript-html-css-week-of-march-24-2014/ "Best of JavaScript, HTML & CSS – Week of March 24, 2014")
    [Best of JavaScript, HTML & CSS – Week of March 24,
    2014](http://flippinawesome.org/2014/04/02/best-of-javascript-html-css-week-of-march-24-2014/ "Best of JavaScript, HTML & CSS – Week of March 24, 2014")
-   [![choice\_header](http://flippinawesome.org/wp-content/uploads/2014/03/choice_header-110x110.jpg)](http://flippinawesome.org/2014/03/31/paralyzed-by-choice-in-front-end-development/ "Paralyzed by Choice in Front-end Development")
    [Paralyzed by Choice in Front-end
    Development](http://flippinawesome.org/2014/03/31/paralyzed-by-choice-in-front-end-development/ "Paralyzed by Choice in Front-end Development")
-   [![npm\_header](http://flippinawesome.org/wp-content/uploads/2014/03/npm_header-110x110.jpg)](http://flippinawesome.org/2014/03/31/introduction-to-npm/ "Introduction to npm")
    [Introduction to
    npm](http://flippinawesome.org/2014/03/31/introduction-to-npm/ "Introduction to npm")
-   [![oscillators\_header](http://flippinawesome.org/wp-content/uploads/2014/03/oscillators_header-110x110.jpg)](http://flippinawesome.org/2014/03/31/creating-sound-with-the-web-audio-api-and-oscillators/ "Creating Sound with the Web Audio API and Oscillators")
    [Creating Sound with the Web Audio API and
    Oscillators](http://flippinawesome.org/2014/03/31/creating-sound-with-the-web-audio-api-and-oscillators/ "Creating Sound with the Web Audio API and Oscillators")
-   [](http://flippinawesome.org/2014/03/26/web-standards-library-update-week-of-march-17-2014/ "Web Standards Library Update – Week of March 17, 2014")
    [Web Standards Library Update – Week of March 17,
    2014](http://flippinawesome.org/2014/03/26/web-standards-library-update-week-of-march-17-2014/ "Web Standards Library Update – Week of March 17, 2014")

** [DW Focus](http://flippinawesome.org/ "DW Focus")

-   [**](https://www.facebook.com/flippin.awesome.dev "Facebook")
-   [**](http://twitter.com/remotesynth "Twitter")
-   [**](http://feeds.feedburner.com/FlippinAwesome "Rss")
-   [**](http://flippinawesome.org/wp-login.php?redirect_to=http%3A%2F%2Fflippinawesome.org%2F2013%2F07%2F29%2Fwriting-a-command-line-utility-using-node%2F "Login")

-   [About](http://flippinawesome.org/about/)**
    -   [Authors](http://flippinawesome.org/authors/)
    -   [Write for Us](http://flippinawesome.org/write-for-us/)

-   [Mailing List](http://flippinawesome.org/mailing-list/)
-   [Podcast](/topic-undefined/)**
    -   [Latest
        Episode](http://flippinawesome.org/topic-undefined/topic-undefined-episode-7/)

-   [Web Development](http://flippinawesome.org/category/web/)
    **
    -   [JavaScript](http://flippinawesome.org/category/web/javascript/)
    -   [CSS](http://flippinawesome.org/category/web/css/)
    -   [HTML](http://flippinawesome.org/category/web/html/)

    -   [![es6\_header](http://flippinawesome.org/wp-content/uploads/2014/04/es6_header-110x110.jpg)](http://flippinawesome.org/2014/04/14/ecmascript-6-jump-in-the-water-is-warm/ "ECMAScript 6: Jump in, the water is warm!")
        [ECMAScript 6: Jump in, the water is
        warm!](http://flippinawesome.org/2014/04/14/ecmascript-6-jump-in-the-water-is-warm/ "ECMAScript 6: Jump in, the water is warm!")
        - 2 days ago
    -   [![browser\_detection\_header](http://flippinawesome.org/wp-content/uploads/2014/04/browser_detection_header-110x110.jpg)](http://flippinawesome.org/2014/04/07/improving-browser-detection/ "Improving Browser Detection")
        [Improving Browser
        Detection](http://flippinawesome.org/2014/04/07/improving-browser-detection/ "Improving Browser Detection")
        - 1 week ago
    -   [![npm\_header](http://flippinawesome.org/wp-content/uploads/2014/03/npm_header-110x110.jpg)](http://flippinawesome.org/2014/03/31/introduction-to-npm/ "Introduction to npm")
        [Introduction to
        npm](http://flippinawesome.org/2014/03/31/introduction-to-npm/ "Introduction to npm")
        - 2 weeks ago
    -   [![oscillators\_header](http://flippinawesome.org/wp-content/uploads/2014/03/oscillators_header-110x110.jpg)](http://flippinawesome.org/2014/03/31/creating-sound-with-the-web-audio-api-and-oscillators/ "Creating Sound with the Web Audio API and Oscillators")
        [Creating Sound with the Web Audio API and
        Oscillators](http://flippinawesome.org/2014/03/31/creating-sound-with-the-web-audio-api-and-oscillators/ "Creating Sound with the Web Audio API and Oscillators")
        - 2 weeks ago
    -   [![string\_harmful](http://flippinawesome.org/wp-content/uploads/2014/03/string_harmful-110x110.jpg)](http://flippinawesome.org/2014/03/24/string-templating-considered-harmful/ "String Templating Considered Harmful")
        [String Templating Considered
        Harmful](http://flippinawesome.org/2014/03/24/string-templating-considered-harmful/ "String Templating Considered Harmful")
        - 3 weeks ago

    [View all](http://flippinawesome.org/category/web/javascript/)
    -   [![Prepocessor\_Architecture\_header](http://flippinawesome.org/wp-content/uploads/2014/04/Prepocessor_Architecture_header-110x110.jpg)](http://flippinawesome.org/2014/04/14/organizing-your-css-code-for-preprocessors/ "Organizing Your CSS Code for Preprocessors")
        [Organizing Your CSS Code for
        Preprocessors](http://flippinawesome.org/2014/04/14/organizing-your-css-code-for-preprocessors/ "Organizing Your CSS Code for Preprocessors")
        - 2 days ago
    -   [![sass\_each\_header](http://flippinawesome.org/wp-content/uploads/2014/03/sass_each_header-110x110.jpg)](http://flippinawesome.org/2014/03/17/doing-more-with-sass-each-control-directive/ "Doing More with Sass’ @each Control Directive")
        [Doing More with Sass’ @each Control
        Directive](http://flippinawesome.org/2014/03/17/doing-more-with-sass-each-control-directive/ "Doing More with Sass’ @each Control Directive")
        - 4 weeks ago
    -   [![react\_grunt\_header](http://flippinawesome.org/wp-content/uploads/2014/03/react_grunt_header-110x110.jpg)](http://flippinawesome.org/2014/03/17/creating-modular-view-components-with-react-and-grunt/ "Creating Modular View Components with React and Grunt")
        [Creating Modular View Components with React and
        Grunt](http://flippinawesome.org/2014/03/17/creating-modular-view-components-with-react-and-grunt/ "Creating Modular View Components with React and Grunt")
        - 4 weeks ago
    -   [![sass\_control\_header](http://flippinawesome.org/wp-content/uploads/2014/02/sass_control_header-110x110.jpg)](http://flippinawesome.org/2014/03/03/getting-into-sass-control-directives/ "Getting into Sass Control Directives")
        [Getting into Sass Control
        Directives](http://flippinawesome.org/2014/03/03/getting-into-sass-control-directives/ "Getting into Sass Control Directives")
        - 1 month ago
    -   [![css\_grid\_header](http://flippinawesome.org/wp-content/uploads/2014/02/css_grid_header-110x110.jpg)](http://flippinawesome.org/2014/03/03/grids-in-css3/ "Grids in CSS3")
        [Grids in
        CSS3](http://flippinawesome.org/2014/03/03/grids-in-css3/ "Grids in CSS3")
        - 1 month ago

    [View all](http://flippinawesome.org/category/web/css/)
    -   [![browser\_detection\_header](http://flippinawesome.org/wp-content/uploads/2014/04/browser_detection_header-110x110.jpg)](http://flippinawesome.org/2014/04/07/improving-browser-detection/ "Improving Browser Detection")
        [Improving Browser
        Detection](http://flippinawesome.org/2014/04/07/improving-browser-detection/ "Improving Browser Detection")
        - 1 week ago
    -   [![string\_harmful](http://flippinawesome.org/wp-content/uploads/2014/03/string_harmful-110x110.jpg)](http://flippinawesome.org/2014/03/24/string-templating-considered-harmful/ "String Templating Considered Harmful")
        [String Templating Considered
        Harmful](http://flippinawesome.org/2014/03/24/string-templating-considered-harmful/ "String Templating Considered Harmful")
        - 3 weeks ago
    -   [![dom\_access\_header](http://flippinawesome.org/wp-content/uploads/2014/03/dom_access_header-110x110.jpg)](http://flippinawesome.org/2014/03/10/a-dom-manipulation-class-in-100-lines-of-javascript/ "A DOM Manipulation Class in 100 Lines of JavaScript")
        [A DOM Manipulation Class in 100 Lines of
        JavaScript](http://flippinawesome.org/2014/03/10/a-dom-manipulation-class-in-100-lines-of-javascript/ "A DOM Manipulation Class in 100 Lines of JavaScript")
        - 1 month ago
    -   [![svg\_header](http://flippinawesome.org/wp-content/uploads/2014/02/svg_header-110x110.jpg)](http://flippinawesome.org/2014/02/03/learning-svg/ "Learning SVG")
        [Learning
        SVG](http://flippinawesome.org/2014/02/03/learning-svg/ "Learning SVG")
        - 2 months ago
    -   [![abbr\_header](http://flippinawesome.org/wp-content/uploads/2014/01/abbr_header-110x110.jpg)](http://flippinawesome.org/2014/01/13/enhancing-the-html-abbr-element-on-mobile/ "Enhancing the HTML abbr Element on Mobile")
        [Enhancing the HTML abbr Element on
        Mobile](http://flippinawesome.org/2014/01/13/enhancing-the-html-abbr-element-on-mobile/ "Enhancing the HTML abbr Element on Mobile")
        - 3 months ago

    [View all](http://flippinawesome.org/category/web/html/)
-   [Mobile Development](http://flippinawesome.org/category/mobile/)
    **
    -   [PhoneGap](http://flippinawesome.org/category/mobile/phonegap/)

    -   [![parallax\_mobile\_header](http://flippinawesome.org/wp-content/uploads/2013/12/parallax_mobile_header-110x110.jpg)](http://flippinawesome.org/2013/12/23/parallax-ui-for-phonegap-and-mobile-web-apps/ "Parallax UI for PhoneGap and Mobile Web Apps")
        [Parallax UI for PhoneGap and Mobile Web
        Apps](http://flippinawesome.org/2013/12/23/parallax-ui-for-phonegap-and-mobile-web-apps/ "Parallax UI for PhoneGap and Mobile Web Apps")
        - 4 months ago
    -   [![mapping\_phonegap\_header](http://flippinawesome.org/wp-content/uploads/2013/12/mapping_phonegap_header1-110x110.jpg)](http://flippinawesome.org/2013/12/09/mobile-friendly-mapping-for-phonegap-apps/ "Mobile-Friendly Mapping for PhoneGap Apps")
        [Mobile-Friendly Mapping for PhoneGap
        Apps](http://flippinawesome.org/2013/12/09/mobile-friendly-mapping-for-phonegap-apps/ "Mobile-Friendly Mapping for PhoneGap Apps")
        - 4 months ago
    -   [](http://flippinawesome.org/2013/04/29/phonegap-build-step-7/ "Create Your First Mobile App with PhoneGap Build – Using the Notification API")
        [Create Your First Mobile App with PhoneGap Build – Using the
        Notification
        API](http://flippinawesome.org/2013/04/29/phonegap-build-step-7/ "Create Your First Mobile App with PhoneGap Build – Using the Notification API")
        - 12 months ago
    -   [](http://flippinawesome.org/2013/04/22/phonegap-build-step-6/ "Create Your First Mobile App with PhoneGap Build – Using the Storage API")
        [Create Your First Mobile App with PhoneGap Build – Using the
        Storage
        API](http://flippinawesome.org/2013/04/22/phonegap-build-step-6/ "Create Your First Mobile App with PhoneGap Build – Using the Storage API")
        - 12 months ago
    -   [](http://flippinawesome.org/2013/04/15/phonegap-build-step-5/ "Create Your First Mobile App with PhoneGap Build – Adding Pages with jQuery Mobile")
        [Create Your First Mobile App with PhoneGap Build – Adding Pages
        with jQuery
        Mobile](http://flippinawesome.org/2013/04/15/phonegap-build-step-5/ "Create Your First Mobile App with PhoneGap Build – Adding Pages with jQuery Mobile")
        - 1 year ago

    [View all](http://flippinawesome.org/category/mobile/phonegap/)
-   [Responsive
    Design](http://flippinawesome.org/category/responsive-web-design/)

Writing a Command Line Utility using Node
=========================================

-   [Featured](http://flippinawesome.org/category/featured/ "View all posts in Featured")
-   [JavaScript](http://flippinawesome.org/category/web/javascript/ "View all posts in JavaScript")
-   [NodeJS](http://flippinawesome.org/category/web/nodejs/ "View all posts in NodeJS")
-   [Web](http://flippinawesome.org/category/web/ "View all posts in Web")

July 29, 2013

![node-cli-header](http://flippinawesome.org/wp-content/uploads/2013/07/node-cli-header.jpg)

*By [Jonathan Fielding](/authors/jonathan-fielding)*

Recently I started writing my own command line utility using Node. In
doing some research, I found a few tutorials including a great one over
at [Javascript
Playground](http://javascriptplayground.com/blog/2012/08/writing-a-command-line-node-tool/),
however many were out of date or left out some key details. In this
article I plan to walk you through all the steps needed to create your
first Node-based command-line utility by showing how to build a simple
command line calculator which takes two values and adds them together.
While the example is simple, the goal is to show the underlying concepts
that you can expand into a more complete and complex utility.

Prerequisites
-------------

Before we get started there are a few prerequisites that we need.

-   [NodeJS](http://nodejs.org/) installed (current version is 0.10.13)
-   NPM installed (this is typically packaged with Node)
-   [Grunt-cli](http://gruntjs.com/) installed (if not run
    `npm install -g grunt-cli`)
-   [Grunt-Init](http://gruntjs.com/) installed (if not run
    `npm install -g grunt-init`)
-   [Node template for
    Grunt-Init](https://github.com/gruntjs/grunt-init-node)
    (`git clone git@github.com:gruntjs/grunt-init-node.git ~/.grunt-init/node`)

Getting Going
-------------

Assuming all the prerequisites installed properly, we can get started
writing our command line tool using Node.

First, create a directory for the new project and use the Terminal to
navigate to it. Next, we will initialize our project using the following
command:

    grunt-init node

When run, grunt-init will ask us some questions about the project before
generating the scaffolding. Below are my answers, obviously you should
customize the responses to suit your needs.

    [?] Project name (calc) calc
    [?] Description (The best project ever.) Simple command line calculator
    [?] Version (0.1.0)
    [?] Project git repository (git://github.com/jonathanfielding/calc.git) git@github.com:jonathan-fielding/CalcCLI.git
    [?] Project homepage (https://github.com/jonathan-fielding/CalcCLI)
    [?] Project issues tracker (https://github.com/jonathan-fielding/CalcCLI/issues)
    [?] Licenses (MIT) 
    [?] Author name (Jonathan Fielding) 
    [?] Author email (j.fielding@me.com) 
    [?] Author url (none) http://www.jonathanfielding.com
    [?] What versions of node does it run on? (>= 0.8.0)
    [?] Main module/entry point (lib/calc) 
    [?] Npm test command (grunt nodeunit)
    [?] Will this project be tested with Travis CI? (Y/n) n
    [?] Do you need to make any changes to the above before continuing? (y/N) n

I should note that if you are on Windows, you might want to choose a
name other than “calc” that doesn’t conflict with pre-existing commands.

Once our project scaffolding is created, let’s take a quick look in our
directory to see what grunt-init has generated.

    Gruntfile.js
    README.md
    package.json
    LICENSE-MIT
    lib/calc.js
    test/calc_test.js

If we load up the package.json in our editor is should look like this:

    {
      "name": "calc",
      "description": "Simple command line calculator",
      "version": "0.1.0",
      "homepage": "https://github.com/jonathan-fielding/CalcCLI",
      "author": {
        "name": "Jonathan Fielding",
        "email": "j.fielding@me.com",
        "url": "http://www.jonathanfielding.com"
      },
      "repository": {
        "type": "git",
        "url": "git@github.com:jonathan-fielding/CalcCLI.git"
      },
      "bugs": {
        "url": "https://github.com/jonathan-fielding/CalcCLI/issues"
      },
      "licenses": [
        {
          "type": "MIT",
          "url": "https://github.com/jonathan-fielding/CalcCLI/blob/master/LICENSE-MIT"
        }
      ],
      "main": "lib/calc",
      "engines": {
        "node": ">= 0.8.0"
      },
      "scripts": {
        "test": "grunt nodeunit"
      },
      "devDependencies": {
        "grunt-contrib-jshint": "~0.6.0",
        "grunt-contrib-nodeunit": "~0.2.0",
        "grunt-contrib-watch": "~0.4.0",
        "grunt": "~0.4.1"
      },
      "keywords": []
    }

We need to tell our package that it should be installed globally if
possible, this can be achieved through adding the
`preferGlobalproperty`. We also want to define the command that we will
use on the command line, we can do this by adding a bin object. This
object needs to list any commands the user may want to enter, for this
example we will add one command `calc`. We will need to point this to
our main JavaScript file for the utility which is lib/calc.js.

    "preferGlobal": "true",
    "bin": {
        "calc" : "lib/calc.js"
    }

We have told our package.json that whenever the user of our utility
enter `calc`, it should run lib/calc.js. However, what we haven’t yet
done is tell our script how it should be executed. We do this by opening
up lib/calc.js and adding this line at the top:

    #! /usr/bin/env node

This tells the script it needs to be executed using Node. At the moment
if we type `calc` into our Terminal, we will receive the error.

    -bash: calc: command not found

This is because we have not installed our package yet so we are unable
to test it. To install our package locally we simply need to run
`npm link` which will give us access to the `calc` command in Terminal.

You will probably notice that when you run this command, npm will
download some files. This is npm downloading all the dependencies
required by your tool that were specified in the package.json.

At the moment when we test our `calc` command nothing will happen; this
is as expected.

When looking in the main plugin file (in this case lib/calc.js) we will
see that grunt-init has generated this code:

    exports.awesome = function() {
      return 'awesome';
    };

As you might expect, `exports` is how we export methods and variables
from a script. These exports can then be used in other scripts. In the
case of our calculator script, this isn’t needed as it is unlikely our
script will be used as part of other scripts. We can delete this.

Passing Arguments
-----------------

We expect the users of our tool to enter the name of our tool then for
the arguments, which in this case are the numbers to add. The command
might look something like this.

    calc 10 10

To achieve this, we need to get the to get the arguments. The parameters
passed are stored in an array `process.argv`. We can output the contents
of this array:

    console.log(process.argv);

If you run `calc 10 10` in your terminal you should see a result similar
to the following:

    [ 'node', '/usr/local/bin/calc', '10' , '10' ]

The first two items in the array relate to how the script is executed
and where the executable is. The third item is the first user defined
argument. To get only the user supplied arguments we can simply slice
the array at index two.

    var userArgs = process.argv.slice(2);

With our `userArgs` stored, we can simply reference the arguments passed
as `userArgs[0]` and `userArgs[1]`. However, to make this easier to read
we can simply store these in variables. Because the original array
stored these as strings, we will need to use `parseInt` to convert them
to an integer.

    var value1 = parseInt(userArgs[0]);
    var value2 = parseInt(userArgs[1]);

We now need to calculate the result of the arguments passed by the user.
For this example we will simply add the two values together.

    var answer = value1 + value2;

Finally, we need to output this answer to the user. We will simply use
`console.log` to output the answer.

    console.log(answer);

Now go back to the Terminal and run the command:

    calc 10 10

The utility will reply with the answer:

    20

At this point we have a very simple calculator for the command line
which allows us to add two values together.

Publishing to npm
-----------------

We already have a working command line utility, but now we want to
publish the utility as a npm module. First we need to authenticate
ourselves or signup with npm. To do this, we run:

    npm adduser

This will ask us to supply a username, password and email address. Once
we are authenticated we need to ensure our project is in a git
repository. We should also check the following:

-   We have added node\_modules/ to our .gitignore, (grunt-init should
    have included a .gitignore file as part of the original template to
    make this easy for us)
-   We also need to ensure that our repository has a valid package.json
    (running `npm link` will verify this).
-   Push your repository to GitHub (or elsewhere, BitBucket offers a
    good alternative) and make sure your package.json has a repository
    object that looks like this:

        "repository": {
           "type": "git",
           "url": "git://github.com/jonathanfielding/calc.git"
         }

Once you have verified these tasks and you are happy with everything,
simply run `npm publish`. This will publish your module and users can
install through `npm install modulename`.

Commanding your Node CLI arguments with Commander.js
----------------------------------------------------

One of the most useful features of a command line utility is the ability
for it to accept arguments from the user. These can vary significantly
from the most simple utility that accepts one argument to a more complex
utility which accepts lot of arguments.

Above, we achieved this through reading the `process.argv` array. Our
original code being:

    var userArgs = process.argv.slice(2);
    var value1 = parseInt(userArgs[0]);
    var value2 = parseInt(userArgs[1]);

This is fine for a small little utility that adds two numbers together
However, this could potentially get quite messy for more complicated
command line utilities. That’s where
[Commander.js](https://github.com/visionmedia/commander.js/)comes in.

Our first step to use Commander.js with our project is to install it
using npm:

    npm install commander --save-dev

After we have installed commander, we now need to use Require to include
it in our project.

    var program = require('commander');

With commander in place we can now replace:

    var userArgs = process.argv.slice(2);

…with:

    program
      .version('0.1.0')
      .option('--number1 ', 'specify the first number to add together',Number)
      .option('--number2 ', 'specify the second number to add together',Number)
      .parse(process.argv);

To retrieve our arguments we can now access them using `program.number1`
and `program.number2`. This means we will need to update the values we
reference to reference these new values.

    var answer = program.number1 + program.number2;

Now if we test our utility we now need to reference the option we want
to pass a value to so the command now becomes:

    calc --number1 20 --number2 20

…which should result in:

    40

As an added bonus, our users will now be able to use `calc --help` to
see all the arguments that our utility accepts.

This is just skimming on the surface of what commander.js is able to
offer, to find out more information visit the [commander.js
website](http://visionmedia.github.io/commander.js/).

Underscore.js, the utility belt for your Node CLI
-------------------------------------------------

Underscore.js is a utility belt library which can be used on both the
frontend and with Node.

Currently, if the user enters a string instead of a number our simple
calculator example the result is `NaN` (not a number). To fix this we
can use Underscore.js to help us to validate whether the result is in
fact a number and if it isn’t we will let the user know they need to
enter numbers.

The first step is for us to install Underscore.js into our project

    npm install underscore --save-dev

Once done we will then need to get Underscore.js by using Require. Add
this directly after the line where we have included commander.js.

    var _ = require('underscore');

Then replace the existing `console.log(answer)` with the following
calculation logic:

    if(_.isUndefined(program.number1) || _.isUndefined(program.number2)){
        console.log('Please check your arguments, check --help for details');
    }
    else{
        if(_.isNaN(program.number1) || _.isNaN(program.number2)){
            console.log('Please only enter numbers');
        }
        else{
            answer = program.number1 + program.number2;
            console.log(answer);
        }
    }

The first portion of this uses Underscore to check if either of the
values is undefined and, if one is, an error message is displayed to the
user. The next step is to check if the numbers entered are in fact
numbers and, if they are not, another error message will be displayed.
Finally, when the two numbers have been entered a result has been
calculated, show it to the user.

This is of course a very simple example of how Underscore.js can be
used.

Help your users to help themselves use your CLI
-----------------------------------------------

If you are familiar with the command line on Mac/\*nix, you will likely
know of the `man` command which allows you to view manuals for different
command line utilities. For example if you enter `man ls` it will load
the manual for the `ls` command.

We can do this with Node command line utilities as well by creating a
man file and adding it to our package.json file.

### Getting started with man

For our manual we will use our existing README.md file, to enable this
to work as a manual using the man command we will need to convert the
README.md file into the correct format. For this we will use a tool
called [marked-man](https://github.com/kapouer/marked-man) which will
take our README.md file and give us a lovely manual (if you’re on
Windows, you can check out the [Groff
tool](http://www.gnu.org/software/groff/groff.html) which adds similar
functionality)

Our first step is to install marked-man.

    npm install marked-man -g

Once this is installed we can simply run the following command to
generate our manual (please note that a subfolder named “doc” will need
to exist otherwise you will get an error):

    marked-man README.md > doc/calc.1

With our manual prepared we can now add it to our package.json file.
This is done by adding an extra item to the JSON object called “man”
with the value set to an array of files that make up your manual.

    "man" :[ "./doc/calc.1" ]

With this added we now need to update the npm link to our plugin by
running.

    npm link

We should now be able to view our new manual in the command line using:

    man calc

Where to Go From Here
---------------------

While it’s unlikely you will use this simple utility on a day to day
basis, hopefully it has allowed you to learn about how to write a
command line utility using Node. There are a lot of modules available
which will help you to enhance both the features and the usability of
your command line utilities. The [NPM registry](https://npmjs.org/) is a
fantastic resource for finding modules that you can use. Through using
NPM modules we can not only save time but we can also be more consistent
with how other command line utilities have been developed.

Credits
-------

Thanks to [Jack Franklin](https://twitter.com/Jack_Franklin) for his
original post, I based this article on what I learnt from his original
post on creating a command line tool using Node.

I based portions of this post partially on some comments on a Reddit
post of the original article. In particular
[ISV\_Damocles](http://www.reddit.com/user/ISV_Damocles) offered some
good suggestions which I then researched to put this piece together.

*This post is a combination of articles originally posted at
[http://www.jonathanfielding.com/writing-a-command-line-utility-using-node/](http://www.jonathanfielding.com/writing-a-command-line-utility-using-node/)
and
[http://www.jonathanfielding.com/ive-written-a-node-cli-so-now-what/](http://www.jonathanfielding.com/ive-written-a-node-cli-so-now-what/)*

Sharing

-   **[Twitter](https://twitter.com/intent/tweet?url=http%3A%2F%2Fflippinawesome.org%2F2013%2F07%2F29%2Fwriting-a-command-line-utility-using-node%2F&text=Writing%20a%20Command%20Line%20Utility%20using%20Node)8
-   **[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fflippinawesome.org%2F2013%2F07%2F29%2Fwriting-a-command-line-utility-using-node%2F&t=Writing%20a%20Command%20Line%20Utility%20using%20Node)0
-   **[Google
    +](https://plus.google.com/share?url=http%3A%2F%2Fflippinawesome.org%2F2013%2F07%2F29%2Fwriting-a-command-line-utility-using-node%2F)0
-   **[Linkedin](http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fflippinawesome.org%2F2013%2F07%2F29%2Fwriting-a-command-line-utility-using-node%2F&title=Writing%20a%20Command%20Line%20Utility%20using%20Node&summary=By%20Jonathan%20Fielding%20Recently%20I%20started%20writing%20my%20own%20command%20line%20utility%20using%20Node.%20In%20doing%20some%20research%2C%20I%20found%20a%20few%20tutorials%20including%20a%20great%20one%20over%20at%20Javascript%20Playground%2C%20however%20many%20were%20out%20of%20date%20or%20left%20out%20some%20key%20details.%20In%20this%20article%20I%20plan%20to%20walk%20you%20through%20all%20the%20steps%20%5B%26hellip%3B%5D)0
-   **[Email this
    article](mailto:?Subject=Writing%20a%20Command%20Line%20Utility%20using%20Node)
-   **[Print this article](javascript:window.print();)

### 9 Comments

1.  ![image](http://0.gravatar.com/avatar/6fefc1f0481eb7c907f7fc4097954420?s=44&d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[daniel](http://danielstern.ca/calculator)
    [3 hours
    ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2270)
    said:

    My host [inmotion] won’t let me install Node.js on my website
    without purchasing the expensive VPN package. Does anyone have any
    suggestions how I can get started with Node?

    [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2270#respond)
    **

    -   ![image](http://1.gravatar.com/avatar/92ac7a41859efee5c2ac7f5c23580e78?s=44&d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)mork
        [12 hours
        ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2294)
        said:

        you can start by getting it up and running locally, no need to
        do it on a remote server.
        [http://nodejs.org/](http://nodejs.org/)

        [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2294#respond)
        **

    -   ![image](http://1.gravatar.com/avatar/b2a38fdac797e589bc15a64605279732?s=44&d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Maurits](http://mauvm.nl)
        [6 hours
        ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2299)
        said:

        Installing NodeJS on your local machine is probably the easiest
        way
        ([http://nodejs.org/download/](http://nodejs.org/download/)).
        Alternatively there is paid hosting
        ([https://github.com/joyent/node/wiki/Node-Hosting](https://github.com/joyent/node/wiki/Node-Hosting)).
        And to get familiar with NodeJS, I can recommend this tutorial:
        [http://net.tutsplus.com/tutorials/javascript-ajax/node-js-for-beginners/](http://net.tutsplus.com/tutorials/javascript-ajax/node-js-for-beginners/).
        TutsPlus has never let me down.
        ![:)](http://flippinawesome.org/wp-includes/images/smilies/icon_smile.gif)

        [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2299#respond)
        **

        -   ![image](http://0.gravatar.com/avatar/6c8618df1a325d0fb9644ee221086fb7?s=44&d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Jonathan
            Fielding](http://www.jonathanfielding.com) [4 hours
            ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2374)
            said:

            My next blog post actually covers the install steps, as its
            a step by step walkthrough setting up grunt including
            installing node etc.

            In meantime I recommend this article
            [http://shapeshed.com/setting-up-nodejs-and-npm-on-mac-osx/](http://shapeshed.com/setting-up-nodejs-and-npm-on-mac-osx/)
            however skip steps to do with NPM as it comes with node on
            homebrew I believe (type npm to confirm)

            [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2374#respond)
            **

            -   ![image](http://0.gravatar.com/avatar/ef97fe5d72f518507e213cf2ed1fa266?s=44&d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Naomi
                Kyoto](https://github.com/naomik) [11 hours
                ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2622)
                said:

                I really wouldn’t recommend this article. Homebrew is
                totally not required as node already provides their own
                pre-compiled binaries for 32-bit and 64-bit versions of
                OS X
                ([http://nodejs.org/download/](http://nodejs.org/download/)).
                Installation is as simple as extracting the tarball and
                the binaries to your path. I’ve explained the details in
                depth here:
                [http://stackoverflow.com/a/17475923/633183](http://stackoverflow.com/a/17475923/633183)

                [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2622#respond)
                **

2.  ![image](http://0.gravatar.com/avatar/6984f97a9bb6ae9d4c45e380a80f8d8a?s=44&d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Eric
    Perez](http://squerly.net) [54 mins
    ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2278)
    said:

    I had to use an alternate syntax to clone ‘Node template for
    Grunt-Init’:\
     git clone
    [https://github.com/gruntjs/grunt-init-node.git](https://github.com/gruntjs/grunt-init-node.git)
    \~/.grunt-init/node

    [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2278#respond)
    **

    -   ![image](http://0.gravatar.com/avatar/6c8618df1a325d0fb9644ee221086fb7?s=44&d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Jonathan
        Fielding](http://www.jonathanfielding.com) [4 hours
        ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2375)
        said:

        Try setting up your GitHub to use SSH,
        [https://help.github.com/articles/generating-ssh-keys](https://help.github.com/articles/generating-ssh-keys)
        this will hopefully fix this issue

        [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2375#respond)
        **

3.  ![image](http://1.gravatar.com/avatar/57c612ae64ddcfae16b2965087da71d9?s=44&d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Gilles
    Ruppert](http://www.madeofbytes.com) [4 hours
    ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2449)
    said:

    Nice article. However, you should only use –save-dev for modules
    that are only necessary during development as those won’t be
    installed when a user installs your module. For regular
    dependencies, use –save.

    [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2449#respond)
    **

4.  ![image](http://0.gravatar.com/avatar/ef97fe5d72f518507e213cf2ed1fa266?s=44&d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D44&r=G)[Naomi
    Kyoto](https://github.com/naomik) [11 hours
    ago](http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/#comment-2619)
    said:

    Yikes. Nice initiative and all, but how about getting people started
    on CLI apps without so many external dependencies? Node and NPM (for
    packaging your module) will get you far enough in this tutorial. I
    could see calling attention to Commander as a useful resource, but
    why bother staring with Grunt right off the starting line?

    [Reply](/2013/07/29/writing-a-command-line-utility-using-node/?replytocom=2619#respond)
    **

### [Cancel reply](/2013/07/29/writing-a-command-line-utility-using-node/#respond)

**Your Name \*

**Your Email \*

**Website \*

### Web & Mobile Development News

[Web Standards Library Update – Week of March 31, 2014](http://flippinawesome.org/2014/04/10/web-standards-library-update-week-of-march-31-2014/ "Web Standards Library Update – Week of March 31, 2014")
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[Best of JavaScript, HTML & CSS – Week of March 31, 2014](http://flippinawesome.org/2014/04/09/best-of-javascript-html-css-march-31-2014/ "Best of JavaScript, HTML & CSS – Week of March 31, 2014")
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[Web Standards Library Update – Week of March 24, 2014](http://flippinawesome.org/2014/04/03/web-standards-library-update-week-of-march-24-2014/ "Web Standards Library Update – Week of March 24, 2014")
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[Best of JavaScript, HTML & CSS – Week of March 24, 2014](http://flippinawesome.org/2014/04/02/best-of-javascript-html-css-week-of-march-24-2014/ "Best of JavaScript, HTML & CSS – Week of March 24, 2014")
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[Web Standards Library Update – Week of March 17, 2014](http://flippinawesome.org/2014/03/26/web-standards-library-update-week-of-march-17-2014/ "Web Standards Library Update – Week of March 17, 2014")
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### Categories

-   [Best
    of](http://flippinawesome.org/category/news/best-of/ "View all posts filed under Best of")
-   [CSS](http://flippinawesome.org/category/web/css/ "View all posts filed under CSS")
-   [Design](http://flippinawesome.org/category/web/design/ "View all posts filed under Design")
-   [Featured](http://flippinawesome.org/category/featured/ "View all posts filed under Featured")
-   [Firefox
    OS](http://flippinawesome.org/category/mobile/firefox-os/ "View all posts filed under Firefox OS")
-   [Game
    Development](http://flippinawesome.org/category/web/game-development/ "View all posts filed under Game Development")
-   [HTML](http://flippinawesome.org/category/web/html/ "View all posts filed under HTML")
-   [JavaScript](http://flippinawesome.org/category/web/javascript/ "View all posts filed under JavaScript")
-   [Mobile](http://flippinawesome.org/category/mobile/ "View all posts filed under Mobile")
-   [News](http://flippinawesome.org/category/news/ "View all posts filed under News")
-   [NodeJS](http://flippinawesome.org/category/web/nodejs/ "View all posts filed under NodeJS")
-   [Opinion](http://flippinawesome.org/category/opinion/ "View all posts filed under Opinion")
-   [PhoneGap](http://flippinawesome.org/category/mobile/phonegap/ "View all posts filed under PhoneGap")
-   [Responsive Web
    Design](http://flippinawesome.org/category/responsive-web-design/ "View all posts filed under Responsive Web Design")
-   [Tools](http://flippinawesome.org/category/web/tools/ "View all posts filed under Tools")
-   [Web](http://flippinawesome.org/category/web/ "View all posts filed under Web")
-   [Wordpress](http://flippinawesome.org/category/web/wordpress/ "View all posts filed under Wordpress")

### Archives

-   [April 2014](http://flippinawesome.org/2014/04/)
-   [March 2014](http://flippinawesome.org/2014/03/)
-   [February 2014](http://flippinawesome.org/2014/02/)
-   [January 2014](http://flippinawesome.org/2014/01/)
-   [December 2013](http://flippinawesome.org/2013/12/)
-   [November 2013](http://flippinawesome.org/2013/11/)
-   [October 2013](http://flippinawesome.org/2013/10/)
-   [September 2013](http://flippinawesome.org/2013/09/)
-   [August 2013](http://flippinawesome.org/2013/08/)
-   [July 2013](http://flippinawesome.org/2013/07/)
-   [June 2013](http://flippinawesome.org/2013/06/)
-   [May 2013](http://flippinawesome.org/2013/05/)
-   [April 2013](http://flippinawesome.org/2013/04/)
-   [March 2013](http://flippinawesome.org/2013/03/)

-   [Flippin' Awesome](http://flippinawesome.org)
-   [Featured](http://flippinawesome.org/category/featured/)
-   Writing a Command Line Utility using Node

Copyright © 2012.

All content is licensed under the [Creative Commons
Attribution-Noncommercial-Share Alike 3.0 Unported
License](http://creativecommons.org/licenses/by-nc-sa/3.0/).

[Flippin' Awesome](http://flippinawesome.org/ "Flippin' Awesome")

[Top](#masthead "Scroll to top")

This markdown document has been converted from the html document located at:
http://flippinawesome.org/2013/07/29/writing-a-command-line-utility-using-node/
